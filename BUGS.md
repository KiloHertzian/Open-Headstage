# Known Issues & Development Status

This document tracks known bugs, significant limitations, and development blockers for the Open Headstage project. It is intended to be kept updated by human developers and AI assistants working on this codebase.

## Instructions for Keeping This File Updated (For AI/LLM Assistants)

**Objective:** Maintain this file as an accurate, concise summary of critical issues affecting development progress or plugin functionality.

**When to Update:**

*   **New Issues:** If a subtask fails unexpectedly due to a previously unknown code bug, compilation error (beyond the already documented `nih-plug` issue), or a tool/dependency problem, add a new entry.
*   **Newly Identified Limitations:** If analysis reveals a new limitation in the current design or implementation (e.g., a feature not fully working as intended, a performance bottleneck discovered), add an entry.
*   **Status Changes:** When a subtask successfully resolves an issue listed here, update its status (e.g., to "Resolved" or "Mitigated") and briefly note the fix.
*   **Clarifications:** If more information about an existing bug becomes available, update its description.

**Format for Bug/Issue Entries:**

*   **Title/Summary:** A brief, clear description of the issue.
*   **Status:** `[Open]`, `[Resolved]`, `[Mitigated]`, `[Workaround Implemented]`
*   **Details:**
    *   A more detailed explanation of the problem.
    *   If code-related, specify the file(s) and relevant sections if known (e.g., `src/sofa/loader.rs`, `MySofa::get_hrtf_irs()`).
    *   If an environment or toolchain issue, describe it as such.
    *   If applicable, mention any error messages observed.
*   **Impact:** Briefly describe how this issue affects the project (e.g., "blocks compilation", "prevents feature X from working", "degrades performance").
*   **Date Identified:** (Optional, but helpful)
*   **Resolution (if applicable):** Briefly describe how the issue was resolved or mitigated.

**Review Cadence:**

*   Review this file at the beginning of any new major task or if the development direction changes significantly.
*   Before submitting changes, consider if any new issues were uncovered or existing ones resolved that need to be reflected here.

**Goal:** Ensure this file serves as a useful, up-to-date reference for any developer (human or AI) jumping into the project. Keep entries clear, factual, and actionable where possible.

---

## Current Known Issues / Development Blockers

1.  **Issue:** Persistent `nih-plug` macro compilation failures.
    *   **Status:** `[Open]`
    *   **Details:** The project consistently fails to compile when using `nih-plug` features that rely on procedural macros, specifically `#[derive(Params)]` and `nih_export_clap!`. The error is typically `E0277: the trait bound <PluginStruct>: ClapPlugin is not satisfied`. This occurs even with minimal plugin examples and various attempts to adjust `nih-plug` versions or dependencies.
    *   **Impact:** Blocks full plugin compilation, testing, and packaging. Prevents functional implementation of parameters and UI interaction via `nih-plug`'s intended mechanisms. Development of core DSP logic proceeds by assuming these macros *would* work in a compatible environment, but integration is conceptual.
    *   **Location:** Primarily affects `src/lib.rs` and `Cargo.toml` interactions with `nih-plug`.

2.  **Issue:** Missing robust error checking for `mysofa_getfilter_float` in `SofaLoader`.
    *   **Status:** `[Open]`
    *   **Details:** The FFI bindings generated by `bindgen` for `libmysofa` do not currently allow easy access to the `error` field of the `MYSOFA_EASY` handle after calling `mysofa_getfilter_float`. The C function `mysofa_getfilter_float` returns an `int` error code, but attempts to use this return value in Rust have resulted in compiler errors suggesting the `bindgen` generated function signature returns `void` (`()`). Simultaneously, accessing `handle->error` has also failed due to the field not being found in the generated Rust struct for `MYSOFA_EASY`.
    *   **Impact:** If `mysofa_getfilter_float` fails to retrieve valid HRIR data (e.g., due to invalid angles for the given SOFA file), the plugin might proceed with incorrect or zeroed IR data without reporting an error, leading to silent failures or incorrect audio output.
    *   **Location:** `src/sofa/loader.rs` in the `MySofa::get_hrtf_irs` method.
    *   **Note:** A `TODO` comment exists in the code regarding this. The `build.rs` includes `allowlist_type("MYSOFA_EASY")` and `allowlist_function("mysofa_getfilter_float")` which were attempts to mitigate this, but the issue persists.

```
